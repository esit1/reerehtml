/*!
	Slimbox v1.71 - The ultimate lightweight Lightbox clone
	(c) 2007-2009 Christophe Beyls <http://www.digitalia.be>
	MIT-style license.
*/
var Slimbox=(function(){var P=window,s=Browser.Engine.trident4,B,j,Q=-1,u,F,O,C,H,Z,y,q={},z=new Image(),W=new Image(),S,g,A,p,V,X,t,D,T,b,k,w,U,f,R,c,L,Y,G,l,e,M;P.addEvent("domready",function(){$(document.body).adopt($$(T=new Element("div",{id:"sbOverlay",events:{click:N}}),b=new Element("div",{id:"sbCenter"}),R=new Element("div",{id:"sbBottomContainer"})).setStyle("display","none"));k=new Element("div",{id:"sbImage"}).injectInside(b).adopt(w=new Element("div",{styles:{position:"relative"}}).adopt(U=new Element("a",{id:"prevLink",href:"#",events:{click:J}}),f=new Element("a",{id:"nextLink",href:"#",events:{click:h}})));c=new Element("div",{id:"sbBottom"}).injectInside(R).adopt(new Element("a",{id:"closeLink",href:"#",events:{click:N}}),X=new Element("a",{id:"playLink",href:"#",events:{click:E}}),t=new Element("a",{id:"pauseLink",href:"#",events:{click:d}}),D=new Element("a",{id:"saveLink",href:"#",target:"_blank"}),L=new Element("div",{id:"sbCaption"}),Y=new Element("div",{id:"sbNumber"}),S=new Element("div",{id:"sbPresent"}),new Element("div",{styles:{clear:"both"}}))});function r(aa){return parseInt(aa.replace(/\D/g,""))}function K(){var aa=P.getScroll(),ab=P.getSize();$$(b,R).setStyle("left",aa.x+(ab.x/2));if(C){T.setStyles({left:aa.x,top:aa.y,width:ab.x,height:ab.y})}}function o(aa){["object",s?"select":"embed"].forEach(function(ac){Array.forEach(document.getElementsByTagName(ac),function(ad){if(aa){ad._slimbox=ad.style.visibility}ad.style.visibility=aa?"hidden":ad._slimbox})});T.style.display=aa?"":"none";var ab=aa?"addEvent":"removeEvent";P[ab]("scroll",K)[ab]("resize",K);document[ab]("keydown",v)}function v(ab){var aa=ab.code;return B.closeKeys.contains(aa)?N():B.nextKeys.contains(aa)?h():B.previousKeys.contains(aa)?J():B.slideshowKeys.contains(aa)?I():false}function J(){return a(F)}function h(){return a(O)}function a(aa){if(aa>=0){Q=aa;u=j[aa][0];F=(Q||(B.loop?j.length:0))-1;O=((Q+1)%j.length)||(B.loop?0:-1);x();b.className="sbLoading";q=new Image();q.onload=n;q.src=u}return false}function n(){b.className="";e.set(0);k.setStyles({backgroundImage:"url("+u+")",display:""});w.setStyle("width",q.width);$$(w,U,f).setStyle("height",q.height);L.set("html",j[Q][1]||"");Y.set("html",(((j.length>1)&&B.counterText)||"").replace(/###x###/,Q+1).replace(/###y###/,j.length));if(g){Y.setStyle("display","none");S.set("html","").setStyle("display","");for(i=0;i<j.length;i++){var ad=Q==i?"act":"no";var aa=new Element("a",{id:"pmi"+(i+1),"class":ad,href:"#",events:{click:function(){var af=r(this.get("id"))-1;d();return a(af)}}});i<9?aa.set("text","0"+(i+1)):aa.set("text",i+1);aa.injectInside(S)}}else{Y.setStyle("display","");S.setStyle("display","none")}if(F>=0){z.src=j[F][0]}if(O>=0){W.src=j[O][0]}Z=k.offsetWidth;y=k.offsetHeight;var ae=Math.max(0,H-(y/2)),ab=0,ac;if(b.offsetHeight!=y){ab=l.start({height:y,top:ae})}if(b.offsetWidth!=Z){ab=l.start({width:Z,marginLeft:-Z/2})}ac=function(){R.setStyles({width:Z,top:ae+y,marginLeft:-Z/2,visibility:"hidden",display:""});e.start(1)};if(ab){l.chain(ac)}else{ac()}}function m(){if(F>=0){U.style.display=""}if(O>=0){f.style.display=""}M.set(-c.offsetHeight).start(0);R.style.visibility="";X.setStyle("display","none");t.setStyle("display","none");if(A){clearTimeout(V);if(p){t.setStyle("display","");if(Q!=(j.length-1)){V=setTimeout(h,B.slideshowInterval)}else{if(B.slideshowAutoclose){V=setTimeout(N,B.slideshowInterval)}else{if(B.loop){V=setTimeout(a,B.slideshowInterval,0)}else{d()}}}}else{X.setStyle("display","")}}B.allowSave?D.set("href",j[Q][0]).setStyle("display",""):D.setStyle("display","none")}function I(){if(p){d()}else{E()}return false}function E(){p=true;if(Q!=(j.length-1)){h()}else{if(B.slideshowAutoclose&&!B.loop){V=setTimeout(N,0)}else{if(B.loop){a(0)}else{}}}return false}function d(){p=false;clearTimeout(V);X.setStyle("display","");t.setStyle("display","none");return false}function x(){q.onload=$empty;q.src=z.src=W.src=u;l.cancel();e.cancel();M.cancel();$$(U,f,k,R).setStyle("display","none")}function N(){if(Q>=0){d();x();Q=F=O=-1;b.style.display="none";G.cancel().chain(o).start(0)}return false}Element.implement({slimbox:function(aa,ab){$$(this).slimbox(aa,ab);return this}});Elements.implement({slimbox:function(aa,ad,ac){ad=ad||function(ae){ae.rel.match(/present.+/)?g=true:g=false;ae.rel.match(/slideshow.+/)?A=true:A=false;return[ae.href,ae.title]};ac=ac||function(){return true};var ab=this;ab.removeEvents("click").addEvent("click",function(){var ae=ab.filter(ac,this);return Slimbox.open(ae.map(ad),ae.indexOf(this),aa)});return ab}});return{open:function(ac,ab,aa){B=$extend({loop:false,overlayOpacity:0.8,overlayFadeDuration:400,resizeDuration:400,resizeTransition:false,initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image ###x### of ###y###",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78],slideshowKeys:[83],allowSave:false,slideshowAutoplay:false,slideshowInterval:3000,slideshowAutoclose:true},aa||{});G=new Fx.Tween(T,{property:"opacity",duration:B.overlayFadeDuration});l=new Fx.Morph(b,$extend({duration:B.resizeDuration,link:"chain"},B.resizeTransition?{transition:B.resizeTransition}:{}));e=new Fx.Tween(k,{property:"opacity",duration:B.imageFadeDuration,onComplete:m});M=new Fx.Tween(c,{property:"margin-top",duration:B.captionAnimationDuration});if(typeof ac=="string"){ac=[[ac,ab]];ab=0}H=P.getScrollTop()+(P.getHeight()/2);Z=B.initialWidth;y=B.initialHeight;b.setStyles({top:Math.max(0,H-(y/2)),width:Z,height:y,marginLeft:-Z/2,display:""});C=s||(T.currentStyle&&(T.currentStyle.position!="fixed"));if(C){T.style.position="absolute"}G.set(0).start(B.overlayOpacity);K();o(1);j=ac;B.loop=B.loop&&(j.length>1);p=B.slideshowAutoplay&&A;return a(ab)}}})();SlimboxOptions=Object.extend({},window.SlimboxOptions||{});Slimbox.scanPage=function(){$$("a").filter(function(a){return a.rel&&a.rel.test(/^lightbox/i)}).slimbox(SlimboxOptions,null,function(a){return(this==a)||((this.rel.length>8)&&(this.rel==a.rel))})};if(!/android|iphone|ipod|series60|symbian|windows ce|blackberry/i.test(navigator.userAgent)){window.addEvent("domready",Slimbox.scanPage)};